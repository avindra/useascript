// ==UserScript==
// @name         useascript
// @namespace    https://dra.vin/
// @version      0.7.0
// @description  A compendium of userscripts for the Web
// @author       Avindra Goolcharan
// @match        *://*/*
// @updateURL    https://dra.vin/useascript/useascript.meta.js
// ==/UserScript==
(()=>{var z=Object.create;var k=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var G=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var v=t=>e=>{var o=t[e];if(o)return o();throw new Error("Module not found in bundle: "+e)};var c=(t,e)=>()=>(t&&(e=t(t=0)),e);var u=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var V=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of W(e))!F.call(t,a)&&a!==o&&k(t,a,{get:()=>e[a],enumerable:!(n=H(e,a))||n.enumerable});return t};var h=(t,e,o)=>(o=t!=null?z(G(t)):{},V(e||!t||!t.__esModule?k(o,"default",{value:t,enumerable:!0}):o,t));var S=u(()=>{if(/\/research\/search_the_collection_database\/search_object_(?:details|image).aspx/.test(location.pathname)){let t=new URLSearchParams(location.search.substring(1)),e=t.get("objectId")||t.get("objectid");e&&(location.href=`/collection/search?keyword=${e}`)}});var $=u(()=>{var J=/s\d+-([cp])/;if(!location.href.includes("4096")){let t=location.href.replace(J,"s4096-$1");t!==location.href&&location.replace(t);let e=location.href.replace(/w\d+-h\d+/,"w4096-h4096");e!==location.href&&location.replace(e)}});var i,l,d=c(()=>{i=t=>new Promise(e=>setTimeout(e,t)),l=t=>{window.onpopstate=t;for(let e of["pushState","replaceState"])window.history[e]=new Proxy(window.history[e],{apply:(o,n,a)=>(t(),o.apply(n,a))});t()}});var Q={};async function K(){let t=/\/([^/]+)\/([^/]+)\/blob\/(.+)\/(.+)/,e=location.pathname.match(t);if(e){let o=document.querySelector("#repos-sticky-header div[class^=prc-ButtonGroup]");if(o){let[,n,a,p,s]=e,f=`https://cdn.jsdelivr.net/gh/${n}/${a}@${p}/${s}`,r=document.createElement("a");r.href=f,r.textContent="JsDelivr",r.className="btn-sm btn BtnGroup-item",o.appendChild(r)}}else if(/\/compare\//.test(location.pathname)){let o=()=>document.querySelectorAll("#commits_bucket .Details:not(.branch-action-item)"),n=0,a;do{if(a=o(),a.length>0)break;await i(500)}while(++n<10);let p=document.querySelector(".range-editor");if(p){let s=document.createElement("button");s.textContent=`Show ${a.length} commits`,s.onclick=()=>{a=o();let f=Array.from(a).map(r=>r.querySelector("p").textContent.trim().replace(/[\s\nâ€¦]+$/g,""));console.log(f,f.join(`
`))},p.appendChild(s)}}y=!1}var y,C=c(()=>{d();y=!1;l(async()=>{y||(y=!0,await i(1e3),setTimeout(K,1e3))})});var X={};var E,Y,q=c(()=>{d();l(()=>{let t=new URLSearchParams(location.search.substring(1)),e;for(let[o]of t.entries())e=o;if(t.get("tbm")==="isch"){t.sort();let o=t.get("q");if(o&&e!=="q"){t.delete("q"),t.set("q",o);let n=`${location.pathname}?${t.toString()}`;location.href=n}}});E=t=>{let e=t.getElementsByTagName("a");for(let o=e[0],n=1;o;n++)o.removeAttribute("data-jsarwt"),o=e[n]},Y=t=>{let e=t.target;E(e)};document.addEventListener("load",E(document.body),!1);document.body.addEventListener("AutoPagerize_DOMNodeInserted",Y,!1)});var N=u(()=>{var Z=`
	.copyright-warning,
	.gita-side-content > div > div:nth-child(2),
	.gita-side-content > div > div:nth-child(3),
	.search-text,
	.gsib_b {
		display:none;
	}

	body {
		background-color: #131b42;
		background-image: none;
	}
`,w=document.createElement("style");w.type="text/css";w.innerText=Z;document.head.appendChild(w);var b=document.querySelector(".bg-verse-audio audio");if(b){b.onended=()=>{let t=document.querySelector(".verse-navigator a.next-element"),e=Array.from(document.querySelectorAll(".actual-verse-navigator a")),o=document.querySelector(".actual-verse-navigator a.active");e[e.length-1]===o?document.querySelector(".chapter-navigator a.next-element").click():t.click()};try{b.play()}catch{}}});var I=u(()=>{var B=document.getElementById("repository"),T=document.createElement("ul"),ee=(t,e)=>{let o=document.createElement("li"),n=document.createElement("a");return n.href=e,n.textContent=t,o.append(n),o};function te(){let t=document.title.substring(0,document.title.length-6),e=[["Bundlephobia",`https://bundlephobia.com/package/${t}`],["anvaka",`https://npm.anvaka.com/#/view/2d/${t}`],["npmgraph",`https://npmgraph.js.org/?q=${t}`],["Packagephobia",`https://packagephobia.com/result?p=${t}`],["pkg-size.dev",`https://pkg-size.dev/${t}`],["npm-stat",`https://npm-stat.com/charts.html?package=${t}`],["deps.dev",`https://deps.dev/npm/${t}`]];for(let[o,n]of e)T.append(ee(o,n));B.parentNode.append(T)}B&&setTimeout(te,500)});var se={};function ae(t){if(["/user","/r"].includes(j))for(let e of t.querySelectorAll("a")){let o=e.getAttribute("href");if(!o)return;if(e.title&&o!=="/s"){let n=document.createElement("span");n.textContent=`(${e.title})`,n.className="titText",e.parentNode.insertBefore(n,e)}/\.(?:(jpe?|pn)g|gif|bmp)/.test(o)?(e.style.color="blue",e.style.fontWeight="bold",o===e.textContent&&(e.textContent="{Image}")):o.indexOf("/")===0||(/https?:\/\/(?:www\.)?reddit\.com/.test(o)?(e.className+=" favicon",e.style.color="crimson",e.style.backgroundImage='url("https://www.reddit.com/static/favicon.ico")'):/https?:\/\/(?:(www|music)\.)?youtube\.com/.test(o)?(e.className+=" favicon",e.style.color="red",e.style.backgroundImage='url("https://s.ytimg.com/yt/favicon.ico")',o===e.textContent&&(e.textContent="{watch on YouTube}")):/http:\/\/(?:www\.)?facebook\.com/.test(o)?(o.match(/[&?]id=(\d+)/)?e.innerHTML=`Profile: {${RegExp.$1}}`:e.pathname.match(/^\/([^?&#]+)/)&&(e.innerHTML=`Profile: ${RegExp.$1}`),e.className+=" favicon",e.style.color="darkBlue",e.style.backgroundImage='url("https://facebook.com/favicon.ico")'):/http:\/\/(?:www\.)?en\.wikipedia\.org\//.test(o)?(/\/wiki\/([^/]+)/.test(e.pathname)&&(e.textContent===o&&(e.innerHTML=""),e.innerHTML+=` <small>{${unescape(RegExp.$1).replace(/_/g," ")}}</small>`),e.style.color="black",e.style.backgroundImage='url("https://en.wikipedia.org/favicon.ico")',e.className+=" favicon"):e.href.startsWith(`${location.protocol}//${location.host}`)||(e.className+=" favicon",e.style.color="darkGreen",e.style.backgroundImage='url("https://upload.wikimedia.org/wikipedia/commons/0/0f/External-link-ltr-icon_Dark.png")',e.style.paddingRight="11px"))}t.marked=!0}var oe,x,ne,j,_=c(()=>{d();oe=`
	.arrow.down {min-width:15px;min-height:14px;}
	.titText {font-size:smaller;color:darkSlateGray;font-weight:bold}
	.favicon {padding-right:17px;font-weight:bold;background-repeat:no-repeat;background-position:right center}
`,x=document.createElement("style");x.type="text/css";x.innerText=oe;document.head.appendChild(x);ne=location.pathname.split(/(?!^)\//),j=ne[0];if(["/media"].includes(j)){let t=document.getElementsByTagName("img")[0],e=document.createElement("canvas"),o=e.getContext("2d");t.crossOrigin="anonymous",t=t.cloneNode(!0),t.onload=()=>{e.width=t.naturalWidth,e.height=t.naturalHeight,o.drawImage(t,0,0),e.toBlob(n=>{let a=URL.createObjectURL(n);location.href=a},"image/jpeg",1)}}(async()=>{for(;;){let t=document.querySelector('[aria-controls="multireddits_section"]');if(t){t.ariaExpanded==="true"&&t.click();break}await i(500)}})();setTimeout(()=>{ae(document.querySelector("main"))},1e3)});var R,A=c(()=>{d();R=async t=>{await i(500);let e=document.querySelector("header nav"),n=e.firstChild.cloneNode(!0),a=document.createTextNode("s");a.textContent="\u{1F4DC}",n.firstChild.firstChild.replaceWith(a),a.parentNode.style.fontSize="25px";let s=n.querySelector("span");Object.assign(s.style,{fontFamily:"monospace",fontSize:"smaller"}),s&&(s.textContent="Useascript"),n.removeAttribute("href"),n.onclick=t,e.prepend(n)}});var g,L,D,O,P=c(()=>{d();g=!0,L=t=>document.evaluate(t,document,null,9,null)?.singleNodeValue,D=t=>{let e=t?"100%":"600px";setTimeout(()=>{let o=L('//*[@data-testid="primaryColumn"]');o&&(o.style.maxWidth=e),setTimeout(()=>{let n=L('//*[@aria-level="1"]/../..');n&&(n.style.maxWidth=e)},1800)},1e3),setTimeout(()=>{let o=document.querySelector('[data-testid="sidebarColumn"]');o&&(g?o.style.display="none":o.style.display="block")},800)},O=()=>(l(()=>{D(g)}),()=>{g=!g,D(g)})});var ie={};var ce,M=c(()=>{A();P();ce=O();R(()=>ce())});var U=u(()=>{if(/^\/(?:c|user|@)\/?/.test(location.pathname)||document.getElementById("page-header")){let t=document.createElement("a"),e=ytInitialData.metadata.channelMetadataRenderer;t.textContent=e.externalId,t.href=e.channelUrl;let o=document.createElement("p");o.appendChild(t),setTimeout(()=>{document.querySelector(".yt-page-header-view-model__page-header-title").nextElementSibling.prepend(o)},1500)}});var re=v({"./britishmuseum.org/index.js":()=>Promise.resolve().then(()=>h(S())),"./ggpht.com/index.js":()=>Promise.resolve().then(()=>h($())),"./github.com/index.js":()=>Promise.resolve().then(()=>(C(),Q)),"./google.com/index.js":()=>Promise.resolve().then(()=>(q(),X)),"./holy-bhagavad-gita.org/index.js":()=>Promise.resolve().then(()=>h(N())),"./npmjs.com/index.js":()=>Promise.resolve().then(()=>h(I())),"./reddit.com/index.js":()=>Promise.resolve().then(()=>(_(),se)),"./x.com/index.js":()=>Promise.resolve().then(()=>(M(),ie)),"./youtube.com/index.js":()=>Promise.resolve().then(()=>h(U()))});var m;switch(location.host){case"github.com":case"x.com":case"mobile.x.com":{m=location.host.split(".").slice(-2).join(".");break}default:{let t=location.host.replace("www.","");switch(t){case"britishmuseum.org":case"holy-bhagavad-gita.org":case"google.com":case"ggpht.com":case"npmjs.com":case"reddit.com":case"youtube.com":m=t;default:/(ggpht|googleusercontent).com$/.test(t)&&(m="ggpht.com")}}}m&&(console.log("loading script",new Date,m),re(`./${m}/index.js`));})();
